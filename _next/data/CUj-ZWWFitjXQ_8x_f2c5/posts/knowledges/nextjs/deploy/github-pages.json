{"pageProps":{"content":"<h1>Deploy</h1>\n<h2>Github pages</h2>\n<p>github pages로 배포를 할 수 있다.\n도메인 명을 원한다면 repo명을 {USERNAME}.github.io 로 생성한다.</p>\n<p>github의 settings에서 github pages를 설정하고 배포할 수 있는데,\nbranch를 master로 설정하게 되면 보통 README.md 파일이 보이는 형태로 배포가 될 것이다.</p>\n<p>nextjs 배포의 기본 전략은, gh-pages라는 다른 branch를 두고, 이 branch에 build된 실행 소스만 커밋하는 전략이다.\n그리고 github pages의 branch를 gh-pages로 설정하면 실행 소스에 대해 따로 배포가 된다.</p>\n<p>next build 로 빌드를 하고\nnext export 로 ./out/ 디렉토리에 실행 소스를 생성한 후\ntouch out/.nojekyll 으로 _next 디렉토리 등 underbar가 prefix로 붙은 디렉토리가 github pages에서 처리하지 않도록 설정해둔다.</p>\n<p>그리고 ./out/ 디렉토리를 gh-pages branch에 push하면 된다.\n방법 중에 하나는 <code>npm i --save-dev gh-pages</code> 모듈을 이용해서\n<code>gh-pages -d out</code>\n으로 push하는 방법이 있다.</p>\n<h3>Github actions</h3>\n<p>master 머지 시 자동으로 배포가 되길 원할 것이다.\n이를 gh actions로 간편하게 할 수 있다.</p>\n<p>위의 배포과정을 동일하게 수행하면 되는데, gh-pages 모듈을 쓰는 대신에</p>\n<pre><code>- name: push .out/ to gh-pages\n- run: |\n  git config user.name github-actions\n  git config user.email github-actions@github.com\n  git --work-tree out add --all\n  git commit -m \"Automatic Deploy action run by github-actions\"\n  git push origin HEAD:gh-pages --force\n</code></pre>\n<p>으로 push를 하면, remote server의 git config 설정을 따로 할 필요가 없어서 간편하다.</p>\n"},"__N_SSG":true}